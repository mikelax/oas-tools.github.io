(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[914],{3454:function(e,n,s){"use strict";var t,i;e.exports=(null==(t=s.g.process)?void 0:t.env)&&"object"===typeof(null==(i=s.g.process)?void 0:i.env)?s.g.process:s(7663)},7644:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/customization/external-modules",function(){return s(3102)}])},4774:function(e,n,s){"use strict";s.d(n,{Z:function(){return a}});var t=s(5893),i={src:"/_next/static/media/isa.5e2e4cad.svg",height:424,width:923},o=s(5675),r=s.n(o),l=function(e){var n=e.height,s=void 0===n?30:n;return(0,t.jsx)(r(),{className:"isalogo",src:i,height:s,width:70})};function a(e){var n=e.locale;return"es-ES"===(void 0===n?"en-US":n)?(0,t.jsxs)("a",{href:"https://isa.us.es",target:"_blank",rel:"noopener",className:"inline-flex items-center no-underline text-current font-semibold",children:[(0,t.jsx)("span",{className:"mr-2",style:{height:30},children:"Desarrollado por"}),(0,t.jsx)("span",{className:"mr-2",children:(0,t.jsx)(l,{})})]}):(0,t.jsxs)("a",{href:"https://isa.us.es",target:"_blank",rel:"noopener",className:"inline-flex items-center no-underline text-current font-semibold",children:[(0,t.jsx)("span",{className:"mr-2",style:{height:30},children:"Powered by"}),(0,t.jsx)("span",{className:"mr-2",children:(0,t.jsx)(l,{})})]})}},4177:function(e,n,s){"use strict";s.d(n,{Z:function(){return l}});var t=s(5893),i={src:"/_next/static/media/oaslogo.34d328ed.png",height:1155,width:1170,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABCklEQVR42mMAgfKvDArZV7iKcq4x12aellVlAAIHB4fZDnaO4QyGDF4qYdONwnPvMPzJvsb8iwEIbNWd7B2cHG4DcTaDk5NTrI2s8/+QqYanCu4zrHCLcPCyNXA8qcjgJsIAAq4xdtX2No6vLRlcVlszuJbamzg9CW910p32n4E345SMDkPyPsWMrEucd3KuM6x1CrC19EyxL82/w3Yx5yrX95zrHLkM+XcYEnKuMf7Pu8Pw06fSYqWjh8OWnJsMT4Aa/udc44lgyDwnJJZ7kyE78zzvZVtdp5c2Mk7/QyYbHSh8zBCceUZSigEEsi7yyha/ZDCx5nCe6ujsMNXB3tHHzc+Zm4GBgQEAIZZaQkv0A+oAAAAASUVORK5CYII="},o=s(5675),r=s.n(o);function l(e){var n=e.size,s=void 0===n?35:n;return(0,t.jsx)(r(),{className:"oaslogo",src:i,height:s,width:s})}},8756:function(e,n,s){"use strict";s.d(n,{Z:function(){return l}});var t=s(4924),i=s(5893),o=s(7294),r=s(7273);function l(e){var n=(0,o.useState)(""),s=n[0],l=n[1];return(0,o.useEffect)((function(){r.Z.initialize((0,t.Z)({startOnLoad:!0,theme:"default",securityLevel:"loose"},"theme","dark")),r.Z.render("diagram-".concat(e.id),String(e.children.props.children).replace(/\\n/g,"<br/>"),(function(e){return l(e)}))}),[]),(0,i.jsx)("div",{id:e.id,className:"mermaid",style:{display:"flex",justifyContent:"center",userSelect:"none",marginTop:"1.5rem"},dangerouslySetInnerHTML:{__html:s}})}},7845:function(e,n,s){"use strict";var t=s(5893),i=s(1163),o=s(4774),r=s(4177),l={"en-US":"Question? Give us feedback \u2192","es-ES":"Ap\xf3rtanos feedback \u2192"};n.Z={projectLink:"https://github.com/oas-tools",docsRepositoryBase:"https://github.com/oas-tools/oas-tools.github.io/blob/main/pages",titleSuffix:" \u2013 OAS Tools",search:!0,unstable_flexsearch:!0,defaultMenuCollapsed:!0,floatTOC:!0,nextLinks:!0,prevLinks:!0,darkMode:!0,footer:!0,footerEditLink:function(e){return"es-ES"===e.locale?"Edite esta p\xe1gina en GitHub \u2192":"Edit this page on GitHub \u2192"},feedbackLabels:"feedback",feedbackLink:function(){var e=(0,i.useRouter)().locale;return l[e]||l["en-US"]},footerText:function(e){return(0,o.Z)(e)},logo:function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Z,{size:35}),(0,t.jsx)("span",{className:"mx-4 font-extrabold hidden md:inline select-none",title:"OAS Tools: A NodeJS OpenAPI Framework",children:"OAS TOOLS"}),(0,t.jsx)("span",{className:"text-gray-500 font-normal hidden md:inline",children:"A NodeJS OpenAPI framework"})]})},head:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/favicon/apple-touch-icon.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon/favicon-32x32.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon/favicon-16x16.png"}),(0,t.jsx)("link",{rel:"manifest",href:"/favicon/site.webmanifest"}),(0,t.jsx)("link",{rel:"mask-icon",href:"/favicon/safari-pinned-tab.svg",color:"#5bbad5"}),(0,t.jsx)("link",{rel:"shortcut icon",href:"/favicon/favicon.ico"}),(0,t.jsx)("meta",{name:"msapplication-TileColor",content:"#ffffff"}),(0,t.jsx)("meta",{name:"msapplication-config",content:"/favicon/browserconfig.xml"}),(0,t.jsx)("meta",{name:"theme-color",content:"#ffffff"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,t.jsx)("meta",{httpEquiv:"Content-Language",content:"en"}),(0,t.jsx)("meta",{name:"description",content:"OAS Tools: A NodeJS OpenAPI framework"}),(0,t.jsx)("meta",{name:"og:description",content:"OAS Tools: A NodeJS OpenAPI framework"}),(0,t.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,t.jsx)("meta",{name:"twitter:image",content:"https://oas-tools.github.io/public/img/og-image.png"}),(0,t.jsx)("meta",{name:"twitter:site:domain",content:"oas-tools.github.io"}),(0,t.jsx)("meta",{name:"twitter:url",content:"https://oas-tools.github.io"}),(0,t.jsx)("meta",{name:"og:title",content:"OAS Tools: A NodeJS OpenAPI framework"}),(0,t.jsx)("meta",{name:"og:image",content:"https://oas-tools.github.io/public/img/og-image.png"}),(0,t.jsx)("meta",{name:"apple-mobile-web-app-title",content:"OAS Tools"}),(0,t.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-icon-180x180.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"192x192",href:"/android-icon-192x192.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"96x96",href:"/favicon-96x96.png"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"}),(0,t.jsx)("meta",{name:"msapplication-TileImage",content:"/ms-icon-144x144.png"})]})}},3102:function(e,n,s){"use strict";s.r(n);var t=s(6042),i=s(9396),o=s(5893),r=s(6147),l=s(7308),a=s(7845),c=s(1151),d=(s(5675),s(8756)),h=[{name:"blog",children:[{name:"articles",children:[{name:"announcingv3",route:"/blog/articles/announcingv3",frontMatter:{image:"oastools3.png",description:"The new OAS Tools version has been finally released. Take a look to all the new features included in OAS Tools v3.0!",date:"2021-08-14T00:00:00.000Z"}},{name:"meta.json",meta:{announcingv3:"OAS Tools v3 is out!"}}],route:"/blog/articles"},{name:"index",route:"/blog",frontMatter:{title:"Blog",searchable:!1}},{name:"meta.json",meta:{index:{type:"page",theme:{sidebar:!1}},articles:{type:"page",theme:{sidebar:!1}}}}],route:"/blog"},{name:"docs",children:[{name:"cli",route:"/docs/cli",frontMatter:{title:"CLI"}},{name:"compatibility",route:"/docs/compatibility",frontMatter:{title:"Compatibility"}},{name:"customization",children:[{name:"custom-loger",route:"/docs/customization/custom-loger",frontMatter:{title:"Custom logger"}},{name:"external-modules",route:"/docs/customization/external-modules",frontMatter:{title:"External Modules"}},{name:"meta.json",meta:{"project-setup":"Advanced project Setup","custom-loger":"Adding a custom logger","external-modules":"External modules"}},{name:"project-setup",route:"/docs/customization/project-setup",frontMatter:{title:"Project Setup"}}],route:"/docs/customization"},{name:"features",children:[{name:"error-handling",route:"/docs/features/error-handling",frontMatter:{title:"Errors"}},{name:"meta.json",meta:{swaggerUI:"Swagger UI",validation:"Validation",routing:"Routing",security:"Security","error-handling":"Handling errors"}},{name:"routing",route:"/docs/features/routing",frontMatter:{title:"Routing"}},{name:"security",route:"/docs/features/security",frontMatter:{title:"Security"}},{name:"swaggerUI",route:"/docs/features/swaggerUI",frontMatter:{title:"SwaggerUI"}},{name:"validation",route:"/docs/features/validation",frontMatter:{title:"Validation"}}],route:"/docs/features"},{name:"fundamentals",children:[{name:"business-logic",route:"/docs/fundamentals/business-logic",frontMatter:{title:"Bussiness logic"}},{name:"config",route:"/docs/fundamentals/config",frontMatter:{title:"Configuration"}},{name:"meta.json",meta:{openapifile:"OpenAPI file",config:"Configuration","business-logic":"Business logic"}},{name:"openapifile",route:"/docs/fundamentals/openapifile",frontMatter:{title:"OpenAPI file"}}],route:"/docs/fundamentals"},{name:"getting-started",children:[{name:"meta.json",meta:{overview:"Overview",quickstart:"Quickstart"}},{name:"overview",route:"/docs/getting-started/overview",frontMatter:{title:"Overview"}},{name:"quickstart",route:"/docs/getting-started/quickstart",frontMatter:{title:"Quickstart"}}],route:"/docs/getting-started"},{name:"meta.json",meta:{"getting-started":"Getting Started",fundamentals:"Fundamentals",features:"Features",cli:"CLI",customization:"Customization",migration:"Migration Guide",compatibility:"Compatibility"}},{name:"migration",route:"/docs/migration",frontMatter:{title:"Migration"}}],route:"/docs"},{name:"meta.json",meta:{docs:{title:"Docs",type:"page"},blog:{title:"Blog",type:"page"}}}];globalThis.__nextra_internal__={pageMap:h,route:"/docs/customization/external-modules"};var p=(0,l.withSSG)((0,r.Z)({filename:"external-modules.mdx",route:"/docs/customization/external-modules",meta:{title:"External Modules"},pageMap:h,titleText:"External modules",headings:[{type:"heading",depth:1,children:[{type:"text",value:"External modules",position:{start:{line:4,column:3,offset:60},end:{line:4,column:19,offset:76}}}],position:{start:{line:4,column:1,offset:58},end:{line:4,column:19,offset:76}},value:"External modules"},{type:"heading",depth:2,children:[{type:"text",value:"Installing modules",position:{start:{line:9,column:4,offset:870},end:{line:9,column:22,offset:888}}}],position:{start:{line:9,column:1,offset:867},end:{line:9,column:22,offset:888}},value:"Installing modules"},{type:"heading",depth:2,children:[{type:"text",value:"Developing modules",position:{start:{line:45,column:4,offset:2664},end:{line:45,column:22,offset:2682}}}],position:{start:{line:45,column:1,offset:2661},end:{line:45,column:22,offset:2682}},value:"Developing modules"},{type:"heading",depth:3,children:[{type:"text",value:"Basic modules",position:{start:{line:48,column:5,offset:2957},end:{line:48,column:18,offset:2970}}}],position:{start:{line:48,column:1,offset:2953},end:{line:48,column:18,offset:2970}},value:"Basic modules"},{type:"heading",depth:3,children:[{type:"text",value:"Complex modules",position:{start:{line:63,column:5,offset:3635},end:{line:63,column:20,offset:3650}}}],position:{start:{line:63,column:1,offset:3631},end:{line:63,column:20,offset:3650}},value:"Complex modules"},{type:"heading",depth:3,children:[{type:"text",value:"Special case: Interceptors",position:{start:{line:109,column:5,offset:5223},end:{line:109,column:31,offset:5249}}}],position:{start:{line:109,column:1,offset:5219},end:{line:109,column:31,offset:5249}},value:"Special case: Interceptors"}],hasH1:!0},a.Z));function u(e){var n=Object.assign({h1:"h1",p:"p",ul:"ul",li:"li",a:"a",h2:"h2",code:"code",strong:"strong",em:"em",blockquote:"blockquote",div:"div",pre:"pre",span:"span",h3:"h3"},(0,c.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{children:"External modules"}),"\n",(0,o.jsx)(n.p,{children:"One of the major new features coming out with this version 3.0 is the possibility to integrate third-party middleware classes and functions into the OAS Tools middleware chain. The OAS Tools' team has already developed a couple of modules that add useful functionalities to the system:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/oas-tools/oas-auth/blob/main/README.md",children:"OAS Auth"}),": An authentication module that provides security handlers and middleware to validate and assign role-based permission levels based on JSON Web Token."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/oas-tools/sla-rate-limit/blob/main/README.md",children:"SLA Rate Limit"}),": A Module capable of reading ",(0,o.jsx)(n.a,{href:"https://sla4oai.specs.governify.io/",children:"SLA4OAI"})," specification and limit the requests to the service based on what has been specified in a service-level agreement (SLA)."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"installing-modules",children:"Installing modules"}),"\n",(0,o.jsxs)(n.p,{children:["External middleware can be installed through the ",(0,o.jsx)(n.code,{children:"use()"})," function provided by the OAS Tools core library. The ",(0,o.jsx)(n.code,{children:"use()"})," function takes three arguments:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Middleware"})," ",(0,o.jsx)(n.em,{children:"(Required)"}),": The imported middleware class or function that is being integrated into the chain."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Configuration"})," ",(0,o.jsx)(n.em,{children:"(optional)"}),": An object containing the configuration for the middleware that is being integrated."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Priotity"})," ",(0,o.jsx)(n.em,{children:"(optional)"}),": The position of the middleware chain in which it will be inserted. By default external modules are inserted in the third position, right after the request validation middleware."]}),"\n"]}),"\n",(0,o.jsx)(d.Z,{children:(0,o.jsx)(n.p,{children:"flowchart LR;\nOAS-PARAMS(0 - Parameter \\n Parser)\nOAS-SECURITY(1 - Security \\nMiddleware)\nOAS-RQVALIDATOR(2 - Request \\n Validation)\nOAS-RPVALIDATOR(4 - Response \\n Validation)\nOAS-ROUTER(5 - Router \\n Middleware)\nEXTERNAL(3 - External \\n Middleware)\nOAS-PARAMS--\x3eOAS-SECURITY\nOAS-SECURITY--\x3eOAS-RQVALIDATOR\nOAS-RQVALIDATOR-.-EXTERNAL\nEXTERNAL-.-OAS-RPVALIDATOR\nOAS-RPVALIDATOR--\x3eOAS-ROUTER\nstyle EXTERNAL stroke-dasharray: 5 5,stroke-width:2px"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Take into account that if two middleware are being inserted at the same position, they will be inserted in the same order in which the ",(0,o.jsx)(n.code,{children:"use()"})," function is called. That means if two middleware are being inserted at position ",(0,o.jsx)(n.code,{children:"0"}),", the first one will end up in position ",(0,o.jsx)(n.code,{children:"1"})," and the second one in position ",(0,o.jsx)(n.code,{children:"0"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The following example shows how the OAS Auth middleware is integrated. It is being registered in the second position of the middleware chain."}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"","data-nextra-code":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" { OASBearerJWT } "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'oas-auth/middleware'"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"authCfg"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {acl"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" { secSchemeName"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'route/to/permissions.json'"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" }}"})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"oasTools"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".use"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(OASBearerJWT"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" authCfg"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"oasTools"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".initialize"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(app)"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".then"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(() "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})})}),"\n",(0,o.jsx)(n.h2,{id:"developing-modules",children:"Developing modules"}),"\n",(0,o.jsxs)(n.p,{children:["Creating new OAS Tools' compatible middleware is as easy as declaring a function or a clase and start using it. That is because the ",(0,o.jsx)(n.code,{children:"use()"})," function accepts middleware functions directly, as well as wrapping classes. The following two sections describe this casuistry."]}),"\n",(0,o.jsx)(n.h3,{id:"basic-modules",children:"Basic modules"}),"\n",(0,o.jsx)(n.p,{children:"In case you want to create a basic middleware for OAS Tools, there is no need to declare a new class. OAS Tools directly accepts function types in the use function. This is perfect when your function doesn't require configuration or a previous initialization operation:"}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"","data-nextra-code":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"myCustomMiddleware"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" (req"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" res"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" next) {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* Do something */"})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"next"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"oasTools"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".use"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(myCustomMiddleware)"})]})]})})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["It is a good practise to declare a function with its name instead of directly declare an unnamed function inside ",(0,o.jsx)(n.code,{children:"use()"}),". This is because the server will log the registered middlewares, and therefore, if your function is unnamed it will print 'undefined'."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"complex-modules",children:"Complex modules"}),"\n",(0,o.jsxs)(n.p,{children:["In case your module requires additional configuration, an initialization process or a complex registration, you will need to declare a class. To make that task easier, the Commons library provides a class, ",(0,o.jsx)(n.em,{children:"OASBase"}),",  which already has the definition for basic functions like registering the middleware."]}),"\n",(0,o.jsxs)(n.p,{children:["When declaring your middleware as a class, you will need to extend ",(0,o.jsx)(n.em,{children:"OASBase"})," and declare a static function ",(0,o.jsx)(n.code,{children:"initialize"})," that receives the module configuration and the OpenAPI document in its arguments, and returns an instance of the class."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["You can easily initialize a new module through the command line interface by running ",(0,o.jsx)(n.code,{children:"oas-tools init module"}),". Check out the ",(0,o.jsx)(n.a,{href:"../cli",children:"CLI section"})]}),"\n"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"","data-nextra-code":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"OASBase"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" } "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"require"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"@oas-tools/commons"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"module"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"exports"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:".MyMiddleware extends OASBase {"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"constructor"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(oasFile"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" middleware) {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"super"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(oasFile"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" middleware); "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// Call parent constructor"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    static "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"initialize"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(oasFile"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" config) {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* The code here will run during OAS Tools initialization */"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"MyMiddleware"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(oasFile"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" (req"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" res"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" next) "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* The code here will run for every request */"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"next"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        })"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(n.span,{className:"line"})]})})}),"\n",(0,o.jsxs)(n.p,{children:["In case you need to perform a more complex registration, you may override the ",(0,o.jsx)(n.code,{children:"register()"})," function, like shown below:"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"","data-nextra-code":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"OASBase"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" } "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"require"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"@oas-tools/commons"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"module"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"exports"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:".MyMiddleware extends OASBase {"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "})]}),"\n",(0,o.jsx)(n.span,{className:"line"}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* Overridden */"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"register"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(app) {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* Do something */"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"app"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".use"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"super.getMiddleware"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"());"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,o.jsx)(n.h3,{id:"special-case-interceptors",children:"Special case: Interceptors"}),"\n",(0,o.jsxs)(n.p,{children:["As explained in the ",(0,o.jsx)(n.a,{href:"../features/validation#intercepting-responses",children:"Validation section"}),", there is a special type of middleware that is capable of intercept responses and perform operations before they are sent to the client. We have called that type of middleware ",(0,o.jsx)(n.em,{children:"interceptors"})," and they are created by overriding the default ",(0,o.jsx)(n.code,{children:"res.send()"})," operation."]}),"\n",(0,o.jsx)(n.p,{children:"When integrating more than one interceptor into the OAS Tools chain, you have to be aware that the order in which they will be executed is inverse to the order in which they are registered. The following flowchart describes this situation:"}),"\n",(0,o.jsx)(d.Z,{children:(0,o.jsx)(n.p,{children:'flowchart LR\nSEND0(["res.send()"])\nSEND1(["res.send1()"])\nSEND2(["res.send2()"])\nSEND2--\x3e|calls| SEND1--\x3e|calls| SEND0\nSEND0-.-|modified by| I1\nI1-.->|produces| SEND1\nSEND1-.-|modified by| I2\nI2-.->|produces| SEND2\nI1(Interceptor 1)\nI2(Interceptor 2)\nstyle I1 stroke-width:3px\nstyle I2 stroke-width:3px'})}),"\n",(0,o.jsxs)(n.p,{children:["As shown in the graph, the first registered interceptor is ",(0,o.jsx)(n.em,{children:"Interceptor1"}),", but the ",(0,o.jsx)(n.em,{children:"send1"})," function produced by it is executed after the function produced by ",(0,o.jsx)(n.em,{children:"Interceptor2"}),", since the controllers will call ",(0,o.jsx)(n.code,{children:"res.send()"}),", which is overriden by ",(0,o.jsx)(n.em,{children:"send2"})," function."]})]})}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},(0,c.ah)(),e.components),s=n.wrapper;return s?(0,o.jsx)(s,(0,i.Z)((0,t.Z)({},e),{children:(0,o.jsx)(u,(0,t.Z)({},e))})):u(e)}function m(e){return(0,o.jsx)(p,(0,i.Z)((0,t.Z)({},e),{children:(0,o.jsx)(x,{})}))}m.getLayout=p.getLayout,n.default=m},7663:function(e){!function(){var n={308:function(e){var n,s,t=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{s="function"===typeof clearTimeout?clearTimeout:o}catch(e){s=o}}();var l,a=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?a=l.concat(a):d=-1,a.length&&p())}function p(){if(!c){var e=r(h);c=!0;for(var n=a.length;n;){for(l=a,a=[];++d<n;)l&&l[d].run();d=-1,n=a.length}l=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(n){try{return s.call(null,e)}catch(n){return s.call(this,e)}}}(e)}}function u(e,n){this.fun=e,this.array=n}function x(){}t.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)n[s-1]=arguments[s];a.push(new u(e,n)),1!==a.length||c||r(p)},u.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=x,t.addListener=x,t.once=x,t.off=x,t.removeListener=x,t.removeAllListeners=x,t.emit=x,t.prependListener=x,t.prependOnceListener=x,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}}},s={};function t(e){var i=s[e];if(void 0!==i)return i.exports;var o=s[e]={exports:{}},r=!0;try{n[e](o,o.exports,t),r=!1}finally{r&&delete s[e]}return o.exports}t.ab="//";var i=t(308);e.exports=i}()}},function(e){e.O(0,[578,873,892,774,888,179],(function(){return n=7644,e(e.s=n);var n}));var n=e.O();_N_E=n}]);